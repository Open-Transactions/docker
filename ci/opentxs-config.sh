#!/bin/bash

OT_BUILD_VARIANT="${1}"

if [ "${OT_BUILD_VARIANT}" == "" ]; then
    echo "Build type not set"
    return 1
elif [ "${OT_BUILD_VARIANT}" == "prod" ]; then
    export OT_OPTIONS="
        -DOT_PCH=ON \
        -DCMAKE_UNITY_BUILD=ON \
        -DCMAKE_UNITY_BUILD_BATCH_SIZE=0 \
        -DOPENTXS_BUILD_TESTS=OFF \
        -DOPENTXS_PEDANTIC_BUILD=ON \
        -DOT_VALGRIND=OFF \
        -DOT_CRYPTO_SUPPORTED_KEY_RSA=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_SECP256K1=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_ED25519=ON \
        -DOT_CRYPTO_USING_LIBSECP256K1=ON \
        -DOT_CRYPTO_USING_OPENSSL=ON \
        -DOT_DHT=ON \
        -DOT_CASH_USING_LUCRE=ON \
        -DOT_SCRIPT_USING_CHAI=ON \
        -DOT_WITH_QT=ON \
        -DOT_WITH_QML=ON \
        -DOT_STORAGE_FS=ON \
        -DOT_STORAGE_SQLITE=ON \
        -DOT_STORAGE_LMDB=ON \
        -DOT_WITH_BLOCKCHAIN=ON \
        -DOT_CRYPTO_USING_PACKETCRYPT=OFF \
        -DOT_ENABLE_RPC=ON"
elif [ "${OT_BUILD_VARIANT}" == "nopch" ]; then
    export OT_OPTIONS="
        -DOT_PCH=OFF \
        -DCMAKE_UNITY_BUILD=OFF \
        -DCMAKE_UNITY_BUILD_BATCH_SIZE=1 \
        -DOPENTXS_BUILD_TESTS=ON \
        -DOPENTXS_PEDANTIC_BUILD=ON \
        -DOT_VALGRIND=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_RSA=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_SECP256K1=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_ED25519=ON \
        -DOT_CRYPTO_USING_LIBSECP256K1=ON \
        -DOT_CRYPTO_USING_OPENSSL=ON \
        -DOT_DHT=ON \
        -DOT_CASH_USING_LUCRE=ON \
        -DOT_SCRIPT_USING_CHAI=ON \
        -DOT_WITH_QT=ON \
        -DOT_WITH_QML=ON \
        -DOT_STORAGE_FS=ON \
        -DOT_STORAGE_SQLITE=ON \
        -DOT_STORAGE_LMDB=ON \
        -DOT_WITH_BLOCKCHAIN=ON \
        -DOT_CRYPTO_USING_PACKETCRYPT=ON \
        -DOT_ENABLE_RPC=ON"
elif [ "${OT_BUILD_VARIANT}" == "full" ]; then
    export OT_OPTIONS="
        -DOT_PCH=ON \
        -DCMAKE_UNITY_BUILD=ON \
        -DCMAKE_UNITY_BUILD_BATCH_SIZE=20 \
        -DOPENTXS_BUILD_TESTS=ON \
        -DOPENTXS_PEDANTIC_BUILD=ON \
        -DOT_VALGRIND=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_RSA=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_SECP256K1=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_ED25519=ON \
        -DOT_CRYPTO_USING_LIBSECP256K1=ON \
        -DOT_CRYPTO_USING_OPENSSL=ON \
        -DOT_DHT=ON \
        -DOT_CASH_USING_LUCRE=ON \
        -DOT_SCRIPT_USING_CHAI=ON \
        -DOT_WITH_QT=ON \
        -DOT_WITH_QML=ON \
        -DOT_STORAGE_FS=ON \
        -DOT_STORAGE_SQLITE=ON \
        -DOT_STORAGE_LMDB=ON \
        -DOT_WITH_BLOCKCHAIN=ON \
        -DOT_CRYPTO_USING_PACKETCRYPT=ON \
        -DOT_ENABLE_RPC=ON"
elif [ "${OT_BUILD_VARIANT}" == "test01" ]; then
    export OT_OPTIONS="
        -DOT_PCH=ON \
        -DCMAKE_UNITY_BUILD=ON \
        -DCMAKE_UNITY_BUILD_BATCH_SIZE=20 \
        -DOPENTXS_BUILD_TESTS=ON \
        -DOPENTXS_PEDANTIC_BUILD=ON \
        -DOT_VALGRIND=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_RSA=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_SECP256K1=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_ED25519=ON \
        -DOT_CRYPTO_USING_LIBSECP256K1=ON \
        -DOT_CRYPTO_USING_OPENSSL=ON \
        -DOT_DHT=OFF \
        -DOT_CASH_USING_LUCRE=OFF \
        -DOT_SCRIPT_USING_CHAI=OFF \
        -DOT_WITH_QT=OFF \
        -DOT_WITH_QML=OFF \
        -DOT_STORAGE_FS=ON \
        -DOT_STORAGE_SQLITE=ON \
        -DOT_STORAGE_LMDB=ON \
        -DOT_WITH_BLOCKCHAIN=ON \
        -DOT_CRYPTO_USING_PACKETCRYPT=OFF \
        -DOT_ENABLE_RPC=OFF"
elif [ "${OT_BUILD_VARIANT}" == "test02" ]; then
    export OT_OPTIONS="
        -DOT_PCH=ON \
        -DCMAKE_UNITY_BUILD=ON \
        -DCMAKE_UNITY_BUILD_BATCH_SIZE=20 \
        -DOPENTXS_BUILD_TESTS=ON \
        -DOPENTXS_PEDANTIC_BUILD=ON \
        -DOT_VALGRIND=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_RSA=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_SECP256K1=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_ED25519=OFF \
        -DOT_CRYPTO_USING_LIBSECP256K1=ON \
        -DOT_CRYPTO_USING_OPENSSL=ON \
        -DOT_DHT=ON \
        -DOT_CASH_USING_LUCRE=ON \
        -DOT_SCRIPT_USING_CHAI=ON \
        -DOT_WITH_QT=ON \
        -DOT_WITH_QML=OFF \
        -DOT_STORAGE_FS=ON \
        -DOT_STORAGE_SQLITE=ON \
        -DOT_STORAGE_LMDB=OFF \
        -DOT_WITH_BLOCKCHAIN=OFF \
        -DOT_CRYPTO_USING_PACKETCRYPT=OFF \
        -DOT_ENABLE_RPC=ON"
elif [ "${OT_BUILD_VARIANT}" == "test03" ]; then
    export OT_OPTIONS="
        -DOT_PCH=ON \
        -DCMAKE_UNITY_BUILD=ON \
        -DCMAKE_UNITY_BUILD_BATCH_SIZE=20 \
        -DOPENTXS_BUILD_TESTS=ON \
        -DOPENTXS_PEDANTIC_BUILD=ON \
        -DOT_VALGRIND=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_RSA=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_SECP256K1=OFF \
        -DOT_CRYPTO_SUPPORTED_KEY_ED25519=ON \
        -DOT_CRYPTO_USING_LIBSECP256K1=OFF \
        -DOT_CRYPTO_USING_OPENSSL=ON \
        -DOT_DHT=OFF \
        -DOT_CASH_USING_LUCRE=OFF \
        -DOT_SCRIPT_USING_CHAI=OFF \
        -DOT_WITH_QT=OFF \
        -DOT_WITH_QML=OFF \
        -DOT_STORAGE_FS=ON \
        -DOT_STORAGE_SQLITE=OFF \
        -DOT_STORAGE_LMDB=ON \
        -DOT_WITH_BLOCKCHAIN=OFF \
        -DOT_CRYPTO_USING_PACKETCRYPT=OFF \
        -DOT_ENABLE_RPC=ON"
elif [ "${OT_BUILD_VARIANT}" == "test04" ]; then
    export OT_OPTIONS="
        -DOT_PCH=ON \
        -DCMAKE_UNITY_BUILD=ON \
        -DCMAKE_UNITY_BUILD_BATCH_SIZE=20 \
        -DOPENTXS_BUILD_TESTS=ON \
        -DOPENTXS_PEDANTIC_BUILD=ON \
        -DOT_VALGRIND=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_RSA=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_SECP256K1=OFF \
        -DOT_CRYPTO_SUPPORTED_KEY_ED25519=OFF \
        -DOT_CRYPTO_USING_LIBSECP256K1=OFF \
        -DOT_CRYPTO_USING_OPENSSL=ON \
        -DOT_DHT=ON \
        -DOT_CASH_USING_LUCRE=ON \
        -DOT_SCRIPT_USING_CHAI=ON \
        -DOT_WITH_QT=ON \
        -DOT_WITH_QML=ON \
        -DOT_STORAGE_FS=ON \
        -DOT_STORAGE_SQLITE=OFF \
        -DOT_STORAGE_LMDB=OFF \
        -DOT_WITH_BLOCKCHAIN=OFF \
        -DOT_CRYPTO_USING_PACKETCRYPT=OFF \
        -DOT_ENABLE_RPC=ON"
elif [ "${OT_BUILD_VARIANT}" == "test05" ]; then
    export OT_OPTIONS="
        -DOT_PCH=ON \
        -DCMAKE_UNITY_BUILD=ON \
        -DCMAKE_UNITY_BUILD_BATCH_SIZE=20 \
        -DOPENTXS_BUILD_TESTS=ON \
        -DOPENTXS_PEDANTIC_BUILD=ON \
        -DOT_VALGRIND=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_RSA=OFF \
        -DOT_CRYPTO_SUPPORTED_KEY_SECP256K1=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_ED25519=ON \
        -DOT_CRYPTO_USING_LIBSECP256K1=ON \
        -DOT_CRYPTO_USING_OPENSSL=OFF \
        -DOT_DHT=OFF \
        -DOT_CASH_USING_LUCRE=OFF \
        -DOT_SCRIPT_USING_CHAI=OFF \
        -DOT_WITH_QT=OFF \
        -DOT_WITH_QML=OFF \
        -DOT_STORAGE_FS=OFF \
        -DOT_STORAGE_SQLITE=ON \
        -DOT_STORAGE_LMDB=ON \
        -DOT_WITH_BLOCKCHAIN=OFF \
        -DOT_CRYPTO_USING_PACKETCRYPT=OFF \
        -DOT_ENABLE_RPC=ON"
elif [ "${OT_BUILD_VARIANT}" == "test06" ]; then
    export OT_OPTIONS="
        -DOT_PCH=ON \
        -DCMAKE_UNITY_BUILD=ON \
        -DCMAKE_UNITY_BUILD_BATCH_SIZE=20 \
        -DOPENTXS_BUILD_TESTS=ON \
        -DOPENTXS_PEDANTIC_BUILD=ON \
        -DOT_VALGRIND=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_RSA=OFF \
        -DOT_CRYPTO_SUPPORTED_KEY_SECP256K1=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_ED25519=OFF \
        -DOT_CRYPTO_USING_LIBSECP256K1=ON \
        -DOT_CRYPTO_USING_OPENSSL=ON \
        -DOT_DHT=ON \
        -DOT_CASH_USING_LUCRE=ON \
        -DOT_SCRIPT_USING_CHAI=ON \
        -DOT_WITH_QT=ON \
        -DOT_WITH_QML=ON \
        -DOT_STORAGE_FS=OFF \
        -DOT_STORAGE_SQLITE=ON \
        -DOT_STORAGE_LMDB=OFF \
        -DOT_WITH_BLOCKCHAIN=OFF \
        -DOT_CRYPTO_USING_PACKETCRYPT=OFF \
        -DOT_ENABLE_RPC=ON"
elif [ "${OT_BUILD_VARIANT}" == "test07" ]; then
    export OT_OPTIONS="
        -DOT_PCH=ON \
        -DCMAKE_UNITY_BUILD=ON \
        -DCMAKE_UNITY_BUILD_BATCH_SIZE=20 \
        -DOPENTXS_BUILD_TESTS=ON \
        -DOPENTXS_PEDANTIC_BUILD=ON \
        -DOT_VALGRIND=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_RSA=OFF \
        -DOT_CRYPTO_SUPPORTED_KEY_SECP256K1=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_ED25519=OFF \
        -DOT_CRYPTO_USING_LIBSECP256K1=ON \
        -DOT_CRYPTO_USING_OPENSSL=ON \
        -DOT_DHT=OFF \
        -DOT_CASH_USING_LUCRE=OFF \
        -DOT_SCRIPT_USING_CHAI=OFF \
        -DOT_WITH_QT=OFF \
        -DOT_WITH_QML=OFF \
        -DOT_STORAGE_FS=OFF \
        -DOT_STORAGE_SQLITE=ON \
        -DOT_STORAGE_LMDB=OFF \
        -DOT_WITH_BLOCKCHAIN=OFF \
        -DOT_CRYPTO_USING_PACKETCRYPT=OFF \
        -DOT_ENABLE_RPC=ON"
elif [ "${OT_BUILD_VARIANT}" == "test08" ]; then
    export OT_OPTIONS="
        -DOT_PCH=ON \
        -DCMAKE_UNITY_BUILD=ON \
        -DCMAKE_UNITY_BUILD_BATCH_SIZE=20 \
        -DOPENTXS_BUILD_TESTS=ON \
        -DOPENTXS_PEDANTIC_BUILD=ON \
        -DOT_VALGRIND=ON \
        -DOT_CRYPTO_SUPPORTED_KEY_RSA=OFF \
        -DOT_CRYPTO_SUPPORTED_KEY_SECP256K1=OFF \
        -DOT_CRYPTO_SUPPORTED_KEY_ED25519=ON \
        -DOT_CRYPTO_USING_LIBSECP256K1=OFF \
        -DOT_CRYPTO_USING_OPENSSL=OFF \
        -DOT_DHT=OFF \
        -DOT_CASH_USING_LUCRE=OFF \
        -DOT_SCRIPT_USING_CHAI=OFF \
        -DOT_WITH_QT=OFF \
        -DOT_WITH_QML=OFF \
        -DOT_STORAGE_FS=OFF \
        -DOT_STORAGE_SQLITE=OFF \
        -DOT_STORAGE_LMDB=ON \
        -DOT_WITH_BLOCKCHAIN=OFF \
        -DOT_CRYPTO_USING_PACKETCRYPT=OFF \
        -DOT_ENABLE_RPC=ON"
else
    echo "Unknown build type: ${OT_BUILD_VARIANT}"
    return 1
fi
